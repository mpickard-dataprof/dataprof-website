---
title: "Left Join"
format: html
---

```{r include=FALSE}
library(tidyverse)

# create example data frames
employees <- tibble(
  muppet_id = c(1, 2, 3, 4, 5),
  names = c(
    "Kermit the Frog",
    "Miss Piggy",
    "Fozzie the Bear",
    "Gonzo",
    "Rowlf the Dog"
  ),
)

positions <- tibble(
  muppet_id = c(1, 2, 3, 4, 8),
  role = c(
    "pragmatic leader",
    "diva pig",
    "stand-up comic",
    "stunt performer",
    "frenzied monster drummer"
  ),
  wage_per_hour = c(75.00, 85.00, 25.25, 54.50, 45.75)
)
```


## What is a left join?
A left join keeps all the rows from the left table and inserts NULLs on the right when there is not a matching row found in the right table.

This Venn diagram illustrates which rows are included in a left join.

![](left_join_venn.svg){height=250 fig-align="center"}

:::{.callout-note}
A left join is the mirror of a right join.
:::

## How does a left join work?
A left join visits every row in the left table and then checks if there is a matching row in the right table. If there is, it combines the matching left and right row.  If there is not, it places nulls on the right side.

::: {layout="[[32,68], [100]]"}
![Left Table](left_join_left_table.svg)

![Right Table](left_join_right_table.svg)

![Left Joined Result](left_join_results.svg)
:::

Notice how the last row (`id=-5`, `name="Rowlf the Dog"`) in the left table does not have a match in the right table. So, nulls are inserted into the right columns of the result.

[The Data School](https://dataschool.com/how-to-teach-people-sql/left-right-join-animated/) provides [a nice animation](https://dataschool.com/assets/images/how-to-teach-people-sql/leftJoin/leftJoin_1.gif) of the row by row operations for a left join.

## How many records end up in the result of an inner join?

$L =$ # of records in the left table

$R =$ # of records in the right table

The number of records in the final left join is $L$. 


## Implementing a left join in different tools
Here is how you perform a left join in [R](#r), [Python](#python), [Power BI](#power-bi), and [Excel](#excel).

### R 
```{r}
library(dplyr)

employees %>% 
  left_join(positions, by = "muppet_id")
```

### Python
```{python echo=FALSE}
employees = r.employees
positions = r.positions
```

```{python}
import pandas as pd

pd.merge(employees, positions, how='left')
```

### Power BI
In Power BI, we invoke Power Query through the Home >> Transform data menu item.
{{< video https://youtu.be/c0X8nrNhwZQ >}}

### Excel
In native Excel, there is not a true left join.  We can use `VLOOKUP()` repeatedly to "join" multiples columns in a "left join" manner. 
{{< video https://youtu.be/m7jESAEYmXw >}}

:::{.callout-note}
Like with Power BI, Power Query is also embedded in Excel. We could also use it in Excel (through the Data >> Get Data menu item).
:::