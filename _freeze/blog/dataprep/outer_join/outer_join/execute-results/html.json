{
  "hash": "82559244552150778524ff48c3442518",
  "result": {
    "markdown": "---\ntitle: \"Outer Join\"\nformat: html\n---\n\n\n\n\n\n## What is a outer join?\nA outer join keeps all the rows from both the right and left tables and inserts NULLs when a matching row is not found in the other table.\n\nThis Venn diagram illustrates which rows are included in a outer join.\n\n![](outer_join_venn.svg){height=250 fig-align=\"center\"}\n\n## How does a outer join work?\nA outer join visits every row in the left table and then checks if there is a matching row in the right table. If there is, it combines the matching left and right row.  If there is not a match, it inserts NULLs in the right columns.  If there are additional primary key values in the right table that were not already inserted from the left table, it inserts those with nulls in the left table columns (since those ids were not found in the left table...only the right table). \n\nIn short, a full outer join is the unique set of rows found in both a left and right join (that's called the intersection -- not to be confused with the intersection of a left and right *table*.  That's an inner join!).\n\n::: {layout=\"[[32,68], [100]]\"}\n![Left Table](outer_join_left_table.svg)\n\n![Right Table](outer_join_right_table.svg)\n\n![Outer Joined Result](outer_join_results.svg)\n:::\n\nNotice how the last row in the left table (`id=5`, `name=\"Rowlf the Dog`) and the last row in the right table (`id=-8`, `role=\"frenzied monster drummer\"`, `wage_per_hour=45.75`) both appear in the final result with NULLs column values that came from the opposite table.\n\n[The Data School](https://dataschool.com/how-to-teach-people-sql/full-outer-join-animated/) provides a nice explanation of the row by row operations for an outer join -- demonstrating that an outer join is a [left join](https://dataschool.com/assets/images/how-to-teach-people-sql/fullOuter/fullOuter_1.gif) combined with a [right join](https://dataschool.com/assets/images/how-to-teach-people-sql/fullOuter/fullOuter_2.gif).\n\n\n## How many records end up in the result of an inner join?\n\n$L =$ # of records in the left table\n\n$R =$ # of records in the right table\n\n*Min number of records*\n$L$ (# of records in the left table)\n\nThis is the case where all the rows in the left and right tables match.\n\n*Max number of records*\n$L$ + $R$\n\nThis is the case where there are no matching rows.\n\n## Implementing a outer join in different tools\nHere is how you perform a outer join in [R](#r), [Python](#python), [Power BI](#power-bi), and [Excel](#excel).\n\n### R \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\nemployees %>% \n  full_join(positions, by = \"muppet_id\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 Ã— 4\n  muppet_id names           role                     wage_per_hour\n      <dbl> <chr>           <chr>                            <dbl>\n1         1 Kermit the Frog pragmatic leader                  75  \n2         2 Miss Piggy      diva pig                          85  \n3         3 Fozzie the Bear stand-up comic                    25.2\n4         4 Gonzo           stunt performer                   54.5\n5         5 Rowlf the Dog   <NA>                              NA  \n6         8 <NA>            frenzied monster drummer          45.8\n```\n:::\n:::\n\n\n### Python\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\n\npd.merge(employees, positions, how='outer')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   muppet_id            names                      role  wage_per_hour\n0        1.0  Kermit the Frog          pragmatic leader          75.00\n1        2.0       Miss Piggy                  diva pig          85.00\n2        3.0  Fozzie the Bear            stand-up comic          25.25\n3        4.0            Gonzo           stunt performer          54.50\n4        5.0    Rowlf the Dog                       NaN            NaN\n5        8.0              NaN  frenzied monster drummer          45.75\n```\n:::\n:::\n\n\n### Power BI\nIn Power BI, we invoke Power Query through the Home >> Transform data menu item.\n\n{{< video https://youtu.be/y1n5ELCyj7Y >}}\n\n\n\n### Excel\nIn native Excel, there is not a true outer join.  The best we can do is mimic an outer join in two steps.  First, we combine the primary key values from both the left and right tables and eliminate duplicates with the \"Remove Duplicates\" feature.  Second, we use those unique primary key values to merge the columns together by using `VLOOKUP()` repeatedly. \n\n\n\n{{< video https://youtu.be/s5TEqker-xI >}}\n\n\n\n:::{.callout-note}\nYou can invoke Power Query in Excel (through the Data >> Get Data menu item) to perform a true outer join.\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}